from math import sqrt, sin, cos, exp
from numpy import array

a = 2.1
b = 3.3
exact = 4.46151

def f(x):
    return 4.5 * cos(7 * x) * exp(-2 * x / 3) + 1.4 * sin(1.5 * x) * exp(-x / 3) + 3

def F(x):
    return array([
        5 * ((x - a) ** (3 / 5)) / 3,

        5 * ((x - a) ** (8 / 5)) / 8 +
        5 * a * ((x - a) ** (3 / 5)) / 3,

        5 * ((x - a) ** (13 / 5)) / 13 +
        5 * a * ((x - a) ** (8 / 5)) / 4 +
        5 * (a ** 2) * ((x - a) ** (3 / 5)) / 3,

        5 * ((x - a) ** (18 / 5)) / 18 +
        15 * a * ((x - a) ** (13 / 5)) / 13 +
        15 * (a ** 2) * ((x - a) ** (8 / 5)) / 8 +
        5 * (a ** 3) * ((x - a) ** (3 / 5)) / 3,

        5 * ((x - a) ** (23 / 5)) / 23 +
        10 * a * ((x - a) ** (18 / 5)) / 9 +
        30 * (a ** 2) * ((x - a) ** (13 / 5)) / 13 +
        5 * (a ** 3) * ((x - a) ** (8 / 5)) / 2 +
        5 * (a ** 4) * ((x - a) ** (3 / 5)) / 3,

        5 * ((x - a) ** (28 / 5)) / 28 +
        25 * a * ((x - a) ** (23 / 5)) / 23 +
        25 * (a ** 2) * ((x - a) ** (18 / 5)) / 9 +
        50 * (a ** 3) * ((x - a) ** (13 / 5)) / 13 +
        25 * (a ** 4) * ((x - a) ** (8 / 5)) / 8 +
        5 * (a ** 5) * ((x - a) ** (3 / 5)) / 3
    ], float)


def moments(l: float, u: float):
    return F(u) - F(l)
