from math import sin, sqrt, cos, exp
import numpy as np

a = 1.5
b = 3.3
exact = 7.07703143799
# alpha = 1/3

def f(x: float):
    return 2 * cos(2.5 * x) * exp(x / 3) + 4 * sin(3.5 * x) * exp(-3 * x) + x


def F(x: float):
    return np.array([
        3 * ((x - a) ** (2 / 3)) / 2,

        3 * ((x - a) ** (5 / 3)) / 5 +
        3 * a * ((x - a) ** (2 / 3)) / 2,

        3 * ((x - a) ** (8 / 3)) / 8 +
        6 * a * ((x - a) ** (5 / 3)) / 5 +
        3 * (a ** 2) * ((x - a) ** (2 / 3)) / 2,

        3 * ((x - a) ** (11 / 3)) / 11 +
        9 * a * ((x - a) ** (8 / 3)) / 8 +
        9 * (a ** 2) * ((x - a) ** (5 / 3)) / 5 +
        3 * (a ** 3) * ((x - a) ** (2 / 3)) / 2,

        3 * ((x - a) ** (14 / 3)) / 14 +
        12 * a * ((x - a) ** (11 / 3)) / 11 +
        9 * (a ** 2) * ((x - a) ** (8 / 3)) / 4 +
        12 * (a ** 3) * ((x - a) ** (5 / 3)) / 5 +
        3 * (a ** 4) * ((x - a) ** (2 / 3)) / 2,

        3 * ((x - a) ** (17 / 3)) / 17 +
        15 * a * ((x - a) ** (14 / 3)) / 14 +
        30 * (a ** 2) * ((x - a) ** (11 / 3)) / 11 +
        15 * (a ** 3) * ((x - a) ** (8 / 3)) / 4 +
        3 * (a ** 4) * ((x - a) ** (5 / 3)) +
        3 * (a ** 5) * ((x - a) ** (2 / 3)) / 2
    ], float)


def moments(l: float, u: float):
    return F(u) - F(l)
